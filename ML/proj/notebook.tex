
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Untitled}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{}The files is “hw2\PYZus{}data\PYZus{}1.txt”.  The data contains two X variables and one Y variable (two classes).}
        \PY{c+c1}{\PYZsh{}Use rows 1\PYZhy{}70 as training data, and use the remaining rows as testing data.}
        
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{sklearn} \PY{k}{as} \PY{n+nn}{sk}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{math} \PY{k}{as} \PY{n+nn}{math}
        \PY{k+kn}{import} \PY{n+nn}{scipy} \PY{k}{as} \PY{n+nn}{sp}
        \PY{k+kn}{from} \PY{n+nn}{functools} \PY{k}{import} \PY{n}{reduce}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{tree}
        \PY{k+kn}{import} \PY{n+nn}{random} \PY{k}{as} \PY{n+nn}{nr}
        \PY{k+kn}{import} \PY{n+nn}{itertools} \PY{k}{as} \PY{n+nn}{it}
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        
        \PY{k}{if} \PY{n+nv+vm}{\PYZus{}\PYZus{}name\PYZus{}\PYZus{}} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}\PYZus{}main\PYZus{}\PYZus{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
            \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} data path specification here}
            \PY{c+c1}{\PYZsh{}use relative path here since the script is in the same directory as the data file}
            \PY{n}{data1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{project\PYZus{}data.txt}\PY{l+s+s2}{\PYZdq{}}
            
        
        
            \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} load the data into pandas dataframe}
            \PY{n}{total\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{data1}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}separator is always important; use \PYZdq{},\PYZdq{} for this small dataset}
        
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{total\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} get a peek at what each column contains}
            
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
   marker.1  marker.2  marker.3  marker.4  marker.5  marker.6  marker.7  \textbackslash{}
0     4.006     5.956     4.045     8.308     7.994     8.230     6.275   
1     6.921     4.383     5.745     5.845     5.236     4.389     3.622   
2     4.159     6.286     7.025     3.297     4.128     5.636     6.005   
3     6.327     4.618     7.290     2.070     5.376     5.558     7.200   
4     5.422     4.010     4.261     1.400     6.232     5.358     6.972   

   marker.8  marker.9  marker.10  {\ldots}  marker.142  marker.143  marker.144  \textbackslash{}
0     7.285     7.230      4.210  {\ldots}       5.296       4.897       9.255   
1     6.835     3.695      4.619  {\ldots}       5.189       6.026       5.296   
2     4.662     3.622      6.764  {\ldots}       3.882       6.262       6.622   
3     2.903     6.346      4.983  {\ldots}       6.238       5.312       6.383   
4     4.847     3.828      4.895  {\ldots}       7.741       7.016       4.951   

   marker.145  marker.146  marker.147  marker.148  marker.149  marker.150  \textbackslash{}
0       3.440       4.040       5.864       5.519       5.121       4.628   
1       2.368       8.547       5.224       5.261       4.915       3.257   
2       5.323       5.994       8.749       8.303       5.186       9.018   
3       7.148       5.695       5.399       5.000       3.035       6.159   
4       5.861       5.819       3.963       5.519       8.272       4.516   

   Phake.Disease  
0              0  
1              1  
2              0  
3              0  
4              1  

[5 rows x 151 columns]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:}     \PY{n+nb}{print}\PY{p}{(}\PY{n}{total\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)} \PY{c+c1}{\PYZsh{} know the shape of the data}
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{total\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)} \PY{c+c1}{\PYZsh{} get the list of column names}
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{total\PYZus{}df}\PY{o}{.}\PY{n}{dtypes}\PY{p}{)} \PY{c+c1}{\PYZsh{} know the data types of each column (float, int, object(string) and etc.)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(1000, 151)
Index(['marker.1', 'marker.2', 'marker.3', 'marker.4', 'marker.5', 'marker.6',
       'marker.7', 'marker.8', 'marker.9', 'marker.10',
       {\ldots}
       'marker.142', 'marker.143', 'marker.144', 'marker.145', 'marker.146',
       'marker.147', 'marker.148', 'marker.149', 'marker.150',
       'Phake.Disease'],
      dtype='object', length=151)
marker.1         float64
marker.2         float64
marker.3         float64
marker.4         float64
marker.5         float64
marker.6         float64
marker.7         float64
marker.8         float64
marker.9         float64
marker.10        float64
marker.11        float64
marker.12        float64
marker.13        float64
marker.14        float64
marker.15        float64
marker.16        float64
marker.17        float64
marker.18        float64
marker.19        float64
marker.20        float64
marker.21        float64
marker.22        float64
marker.23        float64
marker.24        float64
marker.25        float64
marker.26        float64
marker.27        float64
marker.28        float64
marker.29        float64
marker.30        float64
                  {\ldots}   
marker.122       float64
marker.123       float64
marker.124       float64
marker.125       float64
marker.126       float64
marker.127       float64
marker.128       float64
marker.129       float64
marker.130       float64
marker.131       float64
marker.132       float64
marker.133       float64
marker.134       float64
marker.135       float64
marker.136       float64
marker.137       float64
marker.138       float64
marker.139       float64
marker.140       float64
marker.141       float64
marker.142       float64
marker.143       float64
marker.144       float64
marker.145       float64
marker.146       float64
marker.147       float64
marker.148       float64
marker.149       float64
marker.150       float64
Phake.Disease      int64
Length: 151, dtype: object

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}112}]:} \PY{c+c1}{\PYZsh{}Y = np.array(total\PYZus{}df[\PYZsq{}Phake.Disease\PYZsq{}])}
          \PY{c+c1}{\PYZsh{}Y = np.reshape(Y, (1000,1))}
          \PY{c+c1}{\PYZsh{}print(Y)}
          
          \PY{n}{Y} \PY{o}{=} \PY{n}{total\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Phake.Disease}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{c+c1}{\PYZsh{}Y = np.reshape(Y, (1000,1))}
          \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{Y}\PY{p}{)}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}these look evenly mixed, so split can be at index}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}201}]:} \PY{n}{X} \PY{o}{=} \PY{n}{sk}\PY{o}{.}\PY{n}{preprocessing}\PY{o}{.}\PY{n}{normalize}\PY{p}{(}\PY{n}{total\PYZus{}df}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          \PY{n}{X} \PY{o}{=} \PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{150}\PY{p}{]}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}normalizing before ICA}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(1000, 151)
(1000, 150)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{c+c1}{\PYZsh{}do dimension reduction}
         \PY{c+c1}{\PYZsh{}first for the markers and then for the subjects}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{decomposition} \PY{k}{import} \PY{n}{FastICA} 
         \PY{n}{ICA} \PY{o}{=} \PY{n}{FastICA}\PY{p}{(}\PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)} 
         \PY{n}{XD}\PY{o}{=}\PY{n}{ICA}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{XD}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}32}]:} (1000, 3)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{k+kn}{from} \PY{n+nn}{mpl\PYZus{}toolkits}\PY{n+nn}{.}\PY{n+nn}{mplot3d} \PY{k}{import} \PY{n}{Axes3D}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         
         
         \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
         \PY{n}{ax} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{,} \PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{x} \PY{o}{=} \PY{n}{XD}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{y} \PY{o}{=} \PY{n}{XD}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{z} \PY{o}{=} \PY{n}{XD}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{]}
         
         
         
         \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{z}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{Y}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{X Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Y Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}zlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Z Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_6_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{Y}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}43}]:} <matplotlib.collections.PathCollection at 0x7fadb9e4a908>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_7_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{z}\PY{p}{,}\PY{n}{c}\PY{o}{=}\PY{n}{Y}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}44}]:} <matplotlib.collections.PathCollection at 0x7fadb9fe4780>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{z}\PY{p}{,} \PY{n}{y}\PY{p}{,}\PY{n}{c}\PY{o}{=}\PY{n}{Y}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}45}]:} <matplotlib.collections.PathCollection at 0x7fadbf4dc550>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_9_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{c+c1}{\PYZsh{}2}
         \PY{c+c1}{\PYZsh{}clustering}
         \PY{c+c1}{\PYZsh{}k means is quite general purpose, so first done is k means just to get an intuition}
         
         \PY{c+c1}{\PYZsh{} import KMeans}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cluster} \PY{k}{import} \PY{n}{KMeans}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{c+c1}{\PYZsh{} create kmeans object}
         \PY{n}{kmeans} \PY{o}{=} \PY{n}{KMeans}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} fit kmeans object to data}
         \PY{n}{kmeans}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{XD}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} print location of clusters learned by kmeans object}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The centers of the four clusters: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{kmeans}\PY{o}{.}\PY{n}{cluster\PYZus{}centers\PYZus{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} save new clusters for chart}
         \PY{n}{y\PYZus{}km} \PY{o}{=} \PY{n}{kmeans}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XD}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
The centers of the four clusters: 
[[ 0.02533465 -0.02861466 -0.01759948]
 [ 0.01574417  0.0285104   0.02518573]
 [-0.01375063  0.02624619 -0.02604988]
 [-0.02202708 -0.0262839   0.01692675]]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}km} \PY{o}{==}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}km} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}km} \PY{o}{==}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}km} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}km} \PY{o}{==}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}km} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}km} \PY{o}{==}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}km} \PY{o}{==} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cyan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}55}]:} <matplotlib.collections.PathCollection at 0x7fadb8766550>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_12_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{c+c1}{\PYZsh{} create kmeans object}
         \PY{n}{kmeans2} \PY{o}{=} \PY{n}{KMeans}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} fit kmeans object to data}
         \PY{n}{kmeans2}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{XD}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} print location of clusters learned by kmeans object}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{The centers of the four clusters: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{kmeans2}\PY{o}{.}\PY{n}{cluster\PYZus{}centers\PYZus{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} save new clusters for chart}
         \PY{n}{y\PYZus{}km2} \PY{o}{=} \PY{n}{kmeans2}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XD}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}km2} \PY{o}{==}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}km2} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}km2} \PY{o}{==}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}km2} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}the k\PYZhy{}means scatter plots for x,y are near identical}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
The centers of the four clusters: 
[[-1.21419206e-03 -2.89553217e-02 -4.85184439e-05]
 [ 1.23872119e-03  2.95402777e-02  4.94986145e-05]]

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}58}]:} <matplotlib.collections.PathCollection at 0x7fadb862e240>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{c+c1}{\PYZsh{} import hierarchical clustering libraries}
         \PY{c+c1}{\PYZsh{}then Agglomerative, as it starts from the bottom up with each point as a cluster and then merges, maybe it will be diffrent?}
         \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{cluster}\PY{n+nn}{.}\PY{n+nn}{hierarchy} \PY{k}{as} \PY{n+nn}{sch}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cluster} \PY{k}{import} \PY{n}{AgglomerativeClustering}
          
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{c+c1}{\PYZsh{} create dendrogram}
         \PY{n}{dendrogram} \PY{o}{=} \PY{n}{sch}\PY{o}{.}\PY{n}{dendrogram}\PY{p}{(}\PY{n}{sch}\PY{o}{.}\PY{n}{linkage}\PY{p}{(}\PY{n}{XD}\PY{p}{,} \PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ward}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} create clusters}
         \PY{n}{hc} \PY{o}{=} \PY{n}{AgglomerativeClustering}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{affinity} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{euclidean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linkage} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ward}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} save clusters for chart}
         \PY{n}{y\PYZus{}hc} \PY{o}{=} \PY{n}{hc}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XD}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_15_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}hc} \PY{o}{==}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}hc} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}hc}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}hc} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}hc} \PY{o}{==}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}hc} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}hc} \PY{o}{==}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{XD}\PY{p}{[}\PY{n}{y\PYZus{}hc} \PY{o}{==} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cyan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}66}]:} <matplotlib.collections.PathCollection at 0x7fadb36b09e8>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n+nv+vm}{\PYZus{}\PYZus{}doc\PYZus{}\PYZus{}}\PY{p}{)}
         
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cluster} \PY{k}{import} \PY{n}{AffinityPropagation}
         \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
         
         
         
         \PY{c+c1}{\PYZsh{} \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Compute Affinity Propagation}
         \PY{n}{af} \PY{o}{=} \PY{n}{AffinityPropagation}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{XD}\PY{p}{)}
         \PY{n}{cluster\PYZus{}centers\PYZus{}indices} \PY{o}{=} \PY{n}{af}\PY{o}{.}\PY{n}{cluster\PYZus{}centers\PYZus{}indices\PYZus{}}
         \PY{n}{labels} \PY{o}{=} \PY{n}{af}\PY{o}{.}\PY{n}{labels\PYZus{}}
         
         \PY{n}{n\PYZus{}clusters\PYZus{}} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{cluster\PYZus{}centers\PYZus{}indices}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Estimated number of clusters: }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{n\PYZus{}clusters\PYZus{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Homogeneity: }\PY{l+s+si}{\PYZpc{}0.3f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{metrics}\PY{o}{.}\PY{n}{homogeneity\PYZus{}score}\PY{p}{(}\PY{n}{Y}\PY{p}{,} \PY{n}{labels}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Completeness: }\PY{l+s+si}{\PYZpc{}0.3f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{metrics}\PY{o}{.}\PY{n}{completeness\PYZus{}score}\PY{p}{(}\PY{n}{Y}\PY{p}{,} \PY{n}{labels}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{V\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.3f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{metrics}\PY{o}{.}\PY{n}{v\PYZus{}measure\PYZus{}score}\PY{p}{(}\PY{n}{Y}\PY{p}{,} \PY{n}{labels}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Adjusted Rand Index: }\PY{l+s+si}{\PYZpc{}0.3f}\PY{l+s+s2}{\PYZdq{}}
               \PY{o}{\PYZpc{}} \PY{n}{metrics}\PY{o}{.}\PY{n}{adjusted\PYZus{}rand\PYZus{}score}\PY{p}{(}\PY{n}{Y}\PY{p}{,} \PY{n}{labels}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Adjusted Mutual Information: }\PY{l+s+si}{\PYZpc{}0.3f}\PY{l+s+s2}{\PYZdq{}}
               \PY{o}{\PYZpc{}} \PY{n}{metrics}\PY{o}{.}\PY{n}{adjusted\PYZus{}mutual\PYZus{}info\PYZus{}score}\PY{p}{(}\PY{n}{Y}\PY{p}{,} \PY{n}{labels}\PY{p}{,}
                                                    \PY{n}{average\PYZus{}method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{arithmetic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]


Estimated number of clusters: 38
Homogeneity: 0.038
Completeness: 0.007
V-measure: 0.012
Adjusted Rand Index: 0.001
Adjusted Mutual Information: 0.003

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{c+c1}{\PYZsh{} \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Plot result}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{k+kn}{from} \PY{n+nn}{itertools} \PY{k}{import} \PY{n}{cycle}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{all}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{clf}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{colors} \PY{o}{=} \PY{n}{cycle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bgrcmykbgrcmykbgrcmykbgrcmyk}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{col} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}clusters\PYZus{}}\PY{p}{)}\PY{p}{,} \PY{n}{colors}\PY{p}{)}\PY{p}{:}
             \PY{n}{class\PYZus{}members} \PY{o}{=} \PY{n}{labels} \PY{o}{==} \PY{n}{k}
             \PY{n}{cluster\PYZus{}center} \PY{o}{=} \PY{n}{XD}\PY{p}{[}\PY{n}{cluster\PYZus{}centers\PYZus{}indices}\PY{p}{[}\PY{n}{k}\PY{p}{]}\PY{p}{]}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{XD}\PY{p}{[}\PY{n}{class\PYZus{}members}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{XD}\PY{p}{[}\PY{n}{class\PYZus{}members}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{col} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{cluster\PYZus{}center}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{cluster\PYZus{}center}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{markerfacecolor}\PY{o}{=}\PY{n}{col}\PY{p}{,}
                      \PY{n}{markeredgecolor}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{markersize}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}
             \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{XD}\PY{p}{[}\PY{n}{class\PYZus{}members}\PY{p}{]}\PY{p}{:}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{n}{cluster\PYZus{}center}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{cluster\PYZus{}center}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{col}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Estimated number of clusters: }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{n\PYZus{}clusters\PYZus{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}this takes a very dirrfent approach, but even then note that no cluster crosses the line between halves}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_18_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}102}]:} \PY{c+c1}{\PYZsh{}3}
          \PY{c+c1}{\PYZsh{}Split the data in a 3:1:1 ratio into training, validation, and testing sets.}
          
          \PY{c+c1}{\PYZsh{}first append Y to X so that the results are easier to keep track of with the random split}
          \PY{n}{XY} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{XD}\PY{p}{,} \PY{n}{Y}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}109}]:} \PY{n}{XY}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}109}]:} (1000, 4)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}108}]:} \PY{c+c1}{\PYZsh{}then random split at a 3:1:1 ratio}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}108}]:} array([-0.05156666, -0.02692668,  0.01548615])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}136}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}2}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}2} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{Y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.4}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}this should now give a 3:2 split for train and (test+validate)}
          
          \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{X\PYZus{}valid}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}valid} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X\PYZus{}2}\PY{p}{,} \PY{n}{y\PYZus{}2}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{train : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{test : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{valid : }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{X\PYZus{}valid}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{StandardScaler}
          
          \PY{n}{sc} \PY{o}{=} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}  
          \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{sc}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{)}  
          \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{sc}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}  
          \PY{n}{X\PYZus{}valid} \PY{o}{=} \PY{n}{sc}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}valid}\PY{p}{)} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
train :  (600, 150)
test :  (200, 150)
valid :  (200, 150)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}202}]:} \PY{c+c1}{\PYZsh{}Use at least 3 classifiers, and tune each classifier with cross\PYZhy{}validation using the training data. }
          \PY{c+c1}{\PYZsh{}At least one of the classifier should report variable importance. }
          
          \PY{c+c1}{\PYZsh{}First random forest}
          \PY{c+c1}{\PYZsh{}Import Random Forest Model}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{cross\PYZus{}val\PYZus{}score}
          \PY{c+c1}{\PYZsh{}Create a Gaussian Classifier}
          \PY{n}{clf}\PY{o}{=}\PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,}\PY{n}{bootstrap}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{oob\PYZus{}score}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Train the model using the training sets, with cross validation using the training data}
          \PY{n}{clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n}{scores} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}score}\PY{p}{(}\PY{n}{clf}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
          
          
          \PY{n}{y\PYZus{}pred}\PY{o}{=}\PY{n}{clf}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}valid}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}203}]:} \PY{n}{y\PYZus{}pred}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}203}]:} array([1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1,
                 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0,
                 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0,
                 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0,
                 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0,
                 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1,
                 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1,
                 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0,
                 0, 1])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}204}]:} \PY{c+c1}{\PYZsh{}Import scikit\PYZhy{}learn metrics module for accuracy calculation}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
          \PY{c+c1}{\PYZsh{} Model Accuracy, how often is the classifier correct?}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{10 fold CV Random Forest Accuracy:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}valid}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
10 fold CV Random Forest Accuracy: 0.665

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}205}]:} \PY{n}{feature\PYZus{}imp} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{clf}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          \PY{n}{feature\PYZus{}imp}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}205}]:} 74     0.056154
          34     0.041517
          54     0.022209
          39     0.011341
          93     0.009837
          14     0.009652
          61     0.008964
          94     0.008802
          46     0.008533
          87     0.008168
          88     0.008142
          4      0.008121
          24     0.008028
          96     0.008025
          1      0.008018
          33     0.007963
          112    0.007928
          82     0.007831
          41     0.007725
          89     0.007693
          101    0.007653
          66     0.007499
          125    0.007421
          58     0.007417
          83     0.007396
          77     0.007365
          140    0.007305
          120    0.007196
          146    0.007173
          92     0.007161
                   {\ldots}   
          19     0.004945
          128    0.004819
          105    0.004750
          123    0.004714
          25     0.004673
          130    0.004628
          59     0.004622
          12     0.004593
          20     0.004575
          32     0.004517
          102    0.004398
          75     0.004346
          42     0.004266
          111    0.004239
          9      0.004237
          136    0.004185
          71     0.004155
          81     0.004123
          13     0.004122
          18     0.004094
          45     0.004019
          139    0.004015
          121    0.003985
          113    0.003946
          84     0.003929
          44     0.003880
          133    0.003793
          63     0.003413
          91     0.003411
          57     0.003323
          Length: 150, dtype: float64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}206}]:} \PY{c+c1}{\PYZsh{}next is a kernal SVM}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{svm} \PY{k}{import} \PY{n}{SVC}  
          \PY{n}{svm} \PY{o}{=} \PY{n}{SVC}\PY{p}{(}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poly}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{degree}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{gamma} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{scale}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  
          \PY{n}{svm}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
          \PY{n}{scores} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}score}\PY{p}{(}\PY{n}{svm}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{Y}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}207}]:} \PY{n}{y\PYZus{}pred}\PY{o}{=}\PY{n}{svm}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}valid}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Polynomial 4 SVM, 10 fold Accuracy:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}valid}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Polynomial 4 SVM, 10 fold Accuracy: 0.495

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}208}]:} \PY{c+c1}{\PYZsh{}then a small neural net}
          \PY{k+kn}{import} \PY{n+nn}{tensorflow} \PY{k}{as} \PY{n+nn}{tf}
          \PY{k+kn}{from} \PY{n+nn}{tensorflow} \PY{k}{import} \PY{n}{keras}
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          \PY{k+kn}{import} \PY{n+nn}{math} \PY{k}{as} \PY{n+nn}{math}
          \PY{k+kn}{import} \PY{n+nn}{scipy} \PY{k}{as} \PY{n+nn}{sp}
          \PY{k+kn}{from} \PY{n+nn}{functools} \PY{k}{import} \PY{n}{reduce}
          \PY{k+kn}{import} \PY{n+nn}{itertools} \PY{k}{as} \PY{n+nn}{it}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}176}]:} \PY{n}{model1} \PY{o}{=} \PY{n}{keras}\PY{o}{.}\PY{n}{Sequential}\PY{p}{(}\PY{p}{[}
              \PY{c+c1}{\PYZsh{}keras.layers.Flatten(input\PYZus{}shape=(1, 150)),}
              \PY{n}{keras}\PY{o}{.}\PY{n}{layers}\PY{o}{.}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{64}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{nn}\PY{o}{.}\PY{n}{relu}\PY{p}{)}\PY{p}{,}
              \PY{n}{keras}\PY{o}{.}\PY{n}{layers}\PY{o}{.}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{64}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{nn}\PY{o}{.}\PY{n}{relu}\PY{p}{)}\PY{p}{,}
              \PY{n}{keras}\PY{o}{.}\PY{n}{layers}\PY{o}{.}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{nn}\PY{o}{.}\PY{n}{softmax}\PY{p}{)}
          \PY{p}{]}\PY{p}{)}
          
          \PY{n}{model2} \PY{o}{=} \PY{n}{keras}\PY{o}{.}\PY{n}{Sequential}\PY{p}{(}\PY{p}{[}
              \PY{c+c1}{\PYZsh{}keras.layers.Flatten(input\PYZus{}shape=(1, 150)),}
              \PY{n}{keras}\PY{o}{.}\PY{n}{layers}\PY{o}{.}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{128}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{nn}\PY{o}{.}\PY{n}{sigmoid}\PY{p}{)}\PY{p}{,}
              \PY{n}{keras}\PY{o}{.}\PY{n}{layers}\PY{o}{.}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{128}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{nn}\PY{o}{.}\PY{n}{sigmoid}\PY{p}{)}\PY{p}{,}
              \PY{n}{keras}\PY{o}{.}\PY{n}{layers}\PY{o}{.}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{n}{tf}\PY{o}{.}\PY{n}{nn}\PY{o}{.}\PY{n}{softmax}\PY{p}{)}
          \PY{p}{]}\PY{p}{)}
          
          \PY{n}{model1}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{optimizer}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                        \PY{n}{loss}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sparse\PYZus{}categorical\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{metrics}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{model2}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{optimizer}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                        \PY{n}{loss}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sparse\PYZus{}categorical\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{metrics}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          
          
          
          \PY{k}{class} \PY{n+nc}{CollectBatchStats}\PY{p}{(}\PY{n}{tf}\PY{o}{.}\PY{n}{keras}\PY{o}{.}\PY{n}{callbacks}\PY{o}{.}\PY{n}{Callback}\PY{p}{)}\PY{p}{:}
            \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
              \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{batch\PYZus{}losses} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{batch\PYZus{}acc} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              
            \PY{k}{def} \PY{n+nf}{on\PYZus{}batch\PYZus{}end}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{batch}\PY{p}{,} \PY{n}{logs}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
              \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{batch\PYZus{}losses}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{logs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{batch\PYZus{}acc}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{logs}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              
              
          \PY{n}{batch\PYZus{}stats} \PY{o}{=} \PY{n}{CollectBatchStats}\PY{p}{(}\PY{p}{)}
          
          
          
          \PY{n}{history1} \PY{o}{=} \PY{n}{model1}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{,}
                                            \PY{n}{epochs}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{,}
                                            \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{)}
          \PY{n}{history2} \PY{o}{=} \PY{n}{model2}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{,}
                                            \PY{n}{epochs}\PY{o}{=}\PY{l+m+mi}{64}\PY{p}{,}
                                            \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Epoch 1/11
600/600 [==============================] - 0s 264us/sample - loss: 2.1944 - acc: 0.2050
Epoch 2/11
600/600 [==============================] - 0s 19us/sample - loss: 1.5777 - acc: 0.4850
Epoch 3/11
600/600 [==============================] - 0s 32us/sample - loss: 1.1629 - acc: 0.5650
Epoch 4/11
600/600 [==============================] - 0s 30us/sample - loss: 0.9082 - acc: 0.6150
Epoch 5/11
600/600 [==============================] - 0s 20us/sample - loss: 0.7567 - acc: 0.6433
Epoch 6/11
600/600 [==============================] - 0s 32us/sample - loss: 0.6667 - acc: 0.6850
Epoch 7/11
600/600 [==============================] - 0s 22us/sample - loss: 0.6097 - acc: 0.7050
Epoch 8/11
600/600 [==============================] - 0s 31us/sample - loss: 0.5657 - acc: 0.7367
Epoch 9/11
600/600 [==============================] - 0s 24us/sample - loss: 0.5279 - acc: 0.7717
Epoch 10/11
600/600 [==============================] - 0s 25us/sample - loss: 0.4963 - acc: 0.8050
Epoch 11/11
600/600 [==============================] - 0s 26us/sample - loss: 0.4657 - acc: 0.8267
Epoch 1/64
600/600 [==============================] - 0s 274us/sample - loss: 2.2572 - acc: 0.0183
Epoch 2/64
600/600 [==============================] - 0s 21us/sample - loss: 1.2882 - acc: 0.5033
Epoch 3/64
600/600 [==============================] - 0s 25us/sample - loss: 0.8914 - acc: 0.5867
Epoch 4/64
600/600 [==============================] - 0s 33us/sample - loss: 0.7647 - acc: 0.6000
Epoch 5/64
600/600 [==============================] - 0s 26us/sample - loss: 0.7199 - acc: 0.6200
Epoch 6/64
600/600 [==============================] - 0s 28us/sample - loss: 0.6997 - acc: 0.6167
Epoch 7/64
600/600 [==============================] - 0s 33us/sample - loss: 0.6860 - acc: 0.6367
Epoch 8/64
600/600 [==============================] - 0s 26us/sample - loss: 0.6768 - acc: 0.6417
Epoch 9/64
600/600 [==============================] - 0s 30us/sample - loss: 0.6694 - acc: 0.6517
Epoch 10/64
600/600 [==============================] - 0s 26us/sample - loss: 0.6607 - acc: 0.6500
Epoch 11/64
600/600 [==============================] - 0s 29us/sample - loss: 0.6516 - acc: 0.6567
Epoch 12/64
600/600 [==============================] - 0s 30us/sample - loss: 0.6444 - acc: 0.6700
Epoch 13/64
600/600 [==============================] - 0s 27us/sample - loss: 0.6345 - acc: 0.6733
Epoch 14/64
600/600 [==============================] - 0s 29us/sample - loss: 0.6267 - acc: 0.6950
Epoch 15/64
600/600 [==============================] - 0s 29us/sample - loss: 0.6185 - acc: 0.6883
Epoch 16/64
600/600 [==============================] - 0s 31us/sample - loss: 0.6086 - acc: 0.7017
Epoch 17/64
600/600 [==============================] - 0s 30us/sample - loss: 0.5981 - acc: 0.7000
Epoch 18/64
600/600 [==============================] - 0s 29us/sample - loss: 0.5898 - acc: 0.6950
Epoch 19/64
600/600 [==============================] - 0s 29us/sample - loss: 0.5807 - acc: 0.7050
Epoch 20/64
600/600 [==============================] - 0s 29us/sample - loss: 0.5729 - acc: 0.7117
Epoch 21/64
600/600 [==============================] - 0s 28us/sample - loss: 0.5669 - acc: 0.7133
Epoch 22/64
600/600 [==============================] - 0s 29us/sample - loss: 0.5598 - acc: 0.7083
Epoch 23/64
600/600 [==============================] - 0s 33us/sample - loss: 0.5536 - acc: 0.7067
Epoch 24/64
600/600 [==============================] - 0s 28us/sample - loss: 0.5478 - acc: 0.7100
Epoch 25/64
600/600 [==============================] - 0s 29us/sample - loss: 0.5429 - acc: 0.7200
Epoch 26/64
600/600 [==============================] - 0s 27us/sample - loss: 0.5403 - acc: 0.7283
Epoch 27/64
600/600 [==============================] - 0s 28us/sample - loss: 0.5366 - acc: 0.7233
Epoch 28/64
600/600 [==============================] - 0s 25us/sample - loss: 0.5290 - acc: 0.7300
Epoch 29/64
600/600 [==============================] - 0s 26us/sample - loss: 0.5254 - acc: 0.7317
Epoch 30/64
600/600 [==============================] - 0s 29us/sample - loss: 0.5204 - acc: 0.7350
Epoch 31/64
600/600 [==============================] - 0s 30us/sample - loss: 0.5174 - acc: 0.7433
Epoch 32/64
600/600 [==============================] - 0s 30us/sample - loss: 0.5150 - acc: 0.7383
Epoch 33/64
600/600 [==============================] - 0s 28us/sample - loss: 0.5073 - acc: 0.7483
Epoch 34/64
600/600 [==============================] - 0s 32us/sample - loss: 0.5069 - acc: 0.7500
Epoch 35/64
600/600 [==============================] - 0s 25us/sample - loss: 0.5003 - acc: 0.7467
Epoch 36/64
600/600 [==============================] - 0s 27us/sample - loss: 0.4967 - acc: 0.7500
Epoch 37/64
600/600 [==============================] - 0s 27us/sample - loss: 0.4935 - acc: 0.7550
Epoch 38/64
600/600 [==============================] - 0s 41us/sample - loss: 0.4897 - acc: 0.7700
Epoch 39/64
600/600 [==============================] - 0s 27us/sample - loss: 0.4849 - acc: 0.7600
Epoch 40/64
600/600 [==============================] - 0s 28us/sample - loss: 0.4814 - acc: 0.7733
Epoch 41/64
600/600 [==============================] - 0s 27us/sample - loss: 0.4773 - acc: 0.7650
Epoch 42/64
600/600 [==============================] - 0s 32us/sample - loss: 0.4752 - acc: 0.7667
Epoch 43/64
600/600 [==============================] - 0s 28us/sample - loss: 0.4679 - acc: 0.7700
Epoch 44/64
600/600 [==============================] - 0s 31us/sample - loss: 0.4637 - acc: 0.7767
Epoch 45/64
600/600 [==============================] - 0s 27us/sample - loss: 0.4619 - acc: 0.7800
Epoch 46/64
600/600 [==============================] - 0s 34us/sample - loss: 0.4525 - acc: 0.7867
Epoch 47/64
600/600 [==============================] - 0s 33us/sample - loss: 0.4491 - acc: 0.7883
Epoch 48/64
600/600 [==============================] - 0s 29us/sample - loss: 0.4417 - acc: 0.7983
Epoch 49/64
600/600 [==============================] - 0s 27us/sample - loss: 0.4382 - acc: 0.7950
Epoch 50/64
600/600 [==============================] - 0s 27us/sample - loss: 0.4320 - acc: 0.7983
Epoch 51/64
600/600 [==============================] - 0s 25us/sample - loss: 0.4253 - acc: 0.8150
Epoch 52/64
600/600 [==============================] - 0s 27us/sample - loss: 0.4184 - acc: 0.8167
Epoch 53/64
600/600 [==============================] - 0s 30us/sample - loss: 0.4122 - acc: 0.8183
Epoch 54/64
600/600 [==============================] - 0s 26us/sample - loss: 0.4063 - acc: 0.8217
Epoch 55/64
600/600 [==============================] - 0s 25us/sample - loss: 0.3979 - acc: 0.8300
Epoch 56/64
600/600 [==============================] - 0s 30us/sample - loss: 0.3898 - acc: 0.8333
Epoch 57/64
600/600 [==============================] - 0s 27us/sample - loss: 0.3830 - acc: 0.8333
Epoch 58/64
600/600 [==============================] - 0s 27us/sample - loss: 0.3743 - acc: 0.8417
Epoch 59/64
600/600 [==============================] - 0s 25us/sample - loss: 0.3668 - acc: 0.8433
Epoch 60/64
600/600 [==============================] - 0s 25us/sample - loss: 0.3585 - acc: 0.8483
Epoch 61/64
600/600 [==============================] - 0s 29us/sample - loss: 0.3466 - acc: 0.8550
Epoch 62/64
600/600 [==============================] - 0s 28us/sample - loss: 0.3388 - acc: 0.8650
Epoch 63/64
600/600 [==============================] - 0s 25us/sample - loss: 0.3330 - acc: 0.8633
Epoch 64/64
600/600 [==============================] - 0s 27us/sample - loss: 0.3199 - acc: 0.8750

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}175}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{model1}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{model2}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Layer (type)                 Output Shape              Param \#   
=================================================================
dense\_48 (Dense)             multiple                  9664      
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dense\_49 (Dense)             multiple                  4160      
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dense\_50 (Dense)             multiple                  650       
=================================================================
Total params: 14,474
Trainable params: 14,474
Non-trainable params: 0
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
None
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Layer (type)                 Output Shape              Param \#   
=================================================================
dense\_51 (Dense)             multiple                  19328     
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dense\_52 (Dense)             multiple                  16512     
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dense\_53 (Dense)             multiple                  1290      
=================================================================
Total params: 37,130
Trainable params: 37,130
Non-trainable params: 0
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
None

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}178}]:} \PY{c+c1}{\PYZsh{}the validation preformance}
          \PY{n}{prediction1} \PY{o}{=} \PY{n}{model1}\PY{o}{.}\PY{n}{predict\PYZus{}classes}\PY{p}{(}\PY{n}{X\PYZus{}valid}\PY{p}{)}
          \PY{n}{test\PYZus{}accuracy} \PY{o}{=} \PY{n}{tf}\PY{o}{.}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy}\PY{p}{(}\PY{n}{prediction1}\PY{p}{,} \PY{n}{y\PYZus{}valid}\PY{p}{)}
          \PY{n}{acc1} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{for model1: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{k}{for} \PY{p}{(}\PY{n}{s}\PY{p}{,} \PY{n}{w}\PY{p}{)} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{y\PYZus{}valid}\PY{p}{,}\PY{n}{prediction1}\PY{p}{)}\PY{p}{:} 
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{s}\PY{p}{,}\PY{n}{w}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Are equal? }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb}{int}\PY{p}{(}\PY{n}{s} \PY{o}{==} \PY{n}{w}\PY{p}{)}\PY{p}{)}
              \PY{n}{acc1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{s}\PY{o}{==}\PY{n}{w}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
for model1: 
1 1 Are equal?  1
0 1 Are equal?  0
1 0 Are equal?  0
1 1 Are equal?  1
1 1 Are equal?  1
0 1 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
1 1 Are equal?  1
0 0 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
0 1 Are equal?  0
0 1 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
0 1 Are equal?  0
0 1 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
1 1 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
1 1 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
0 1 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
0 0 Are equal?  1
0 0 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
1 1 Are equal?  1
1 0 Are equal?  0
0 1 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
0 1 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
0 1 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
0 1 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
0 1 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
0 1 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
0 0 Are equal?  1
1 1 Are equal?  1
1 1 Are equal?  1
0 1 Are equal?  0
1 1 Are equal?  1
1 0 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
1 1 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
0 1 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
1 1 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
0 1 Are equal?  0
1 1 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
0 1 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
0 1 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
1 1 Are equal?  1
0 1 Are equal?  0
1 1 Are equal?  1
1 0 Are equal?  0
0 1 Are equal?  0
0 0 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
1 1 Are equal?  1
0 1 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
0 0 Are equal?  1
0 1 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
0 0 Are equal?  1
0 0 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
0 1 Are equal?  0
0 0 Are equal?  1
0 1 Are equal?  0
1 1 Are equal?  1
1 0 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
1 1 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
0 0 Are equal?  1
0 0 Are equal?  1
0 1 Are equal?  0
1 1 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
1 1 Are equal?  1
1 1 Are equal?  1
0 0 Are equal?  1
0 1 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
0 1 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
0 0 Are equal?  1
1 1 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
1 1 Are equal?  1
0 1 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}180}]:} \PY{n}{prediction2} \PY{o}{=} \PY{n}{model2}\PY{o}{.}\PY{n}{predict\PYZus{}classes}\PY{p}{(}\PY{n}{X\PYZus{}valid}\PY{p}{)}
          \PY{n}{acc2} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{for model2: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{k}{for} \PY{p}{(}\PY{n}{s}\PY{p}{,} \PY{n}{w}\PY{p}{)} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{y\PYZus{}valid}\PY{p}{,}\PY{n}{prediction2}\PY{p}{)}\PY{p}{:} 
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{s}\PY{p}{,}\PY{n}{w}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Are equal? }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb}{int}\PY{p}{(}\PY{n}{s} \PY{o}{==} \PY{n}{w}\PY{p}{)}\PY{p}{)}
              \PY{n}{acc2}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{s}\PY{o}{==}\PY{n}{w}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
for model2: 
1 1 Are equal?  1
0 1 Are equal?  0
1 1 Are equal?  1
1 1 Are equal?  1
1 1 Are equal?  1
0 1 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
1 1 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
0 1 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
0 0 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
0 1 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
1 1 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
0 1 Are equal?  0
1 1 Are equal?  1
0 1 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
0 0 Are equal?  1
0 0 Are equal?  1
0 1 Are equal?  0
1 0 Are equal?  0
1 1 Are equal?  1
1 1 Are equal?  1
0 1 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
0 1 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
0 1 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
0 1 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
0 0 Are equal?  1
0 1 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
1 1 Are equal?  1
0 1 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
0 1 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
1 1 Are equal?  1
1 1 Are equal?  1
0 1 Are equal?  0
0 1 Are equal?  0
1 1 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
0 1 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
0 1 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
1 1 Are equal?  1
0 1 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1
0 1 Are equal?  0
0 0 Are equal?  1
0 1 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
1 1 Are equal?  1
1 0 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
0 0 Are equal?  1
0 0 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
0 1 Are equal?  0
0 0 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
0 1 Are equal?  0
1 1 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
0 0 Are equal?  1
0 0 Are equal?  1
0 1 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
1 1 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
0 1 Are equal?  0
1 1 Are equal?  1
0 1 Are equal?  0
1 1 Are equal?  1
1 1 Are equal?  1
1 0 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
0 1 Are equal?  0
1 0 Are equal?  0
0 0 Are equal?  1
0 1 Are equal?  0
1 1 Are equal?  1
0 0 Are equal?  1
0 1 Are equal?  0
1 0 Are equal?  0
1 0 Are equal?  0
1 1 Are equal?  1
1 1 Are equal?  1
0 0 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 0 Are equal?  0
0 0 Are equal?  1
1 1 Are equal?  1

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}182}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model1 has a test accuracy of }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{acc1}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{acc1}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model2 has a test accuracy of }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{acc2}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{acc2}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
model1 has a test accuracy of  0.52 \%
model2 has a test accuracy of  0.47 \%

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}194}]:} \PY{c+c1}{\PYZsh{}best was 1, so that is what we will use the K\PYZhy{}fold on}
          
          \PY{c+c1}{\PYZsh{} Create function returning a compiled network}
          \PY{k}{def} \PY{n+nf}{create\PYZus{}network}\PY{p}{(}\PY{p}{)}\PY{p}{:}
              
              \PY{c+c1}{\PYZsh{} Start neural network}
              \PY{n}{network} \PY{o}{=} \PY{n}{keras}\PY{o}{.}\PY{n}{Sequential}\PY{p}{(}\PY{p}{)}
          
              \PY{c+c1}{\PYZsh{} Add fully connected layer with a ReLU activation function}
              \PY{n}{network}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{keras}\PY{o}{.}\PY{n}{layers}\PY{o}{.}\PY{n}{Dense}\PY{p}{(}\PY{n}{units}\PY{o}{=}\PY{l+m+mi}{64}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          
              \PY{c+c1}{\PYZsh{} Add fully connected layer with a ReLU activation function}
              \PY{n}{network}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{keras}\PY{o}{.}\PY{n}{layers}\PY{o}{.}\PY{n}{Dense}\PY{p}{(}\PY{n}{units}\PY{o}{=}\PY{l+m+mi}{64}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          
              \PY{c+c1}{\PYZsh{} Add fully connected layer with a sigmoid activation function}
              \PY{n}{network}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{keras}\PY{o}{.}\PY{n}{layers}\PY{o}{.}\PY{n}{Dense}\PY{p}{(}\PY{n}{units}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{softmax}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          
              \PY{c+c1}{\PYZsh{} Compile neural network}
              \PY{n}{network}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{loss}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{} Cross\PYZhy{}entropy}
                              \PY{n}{optimizer}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{} Root Mean Square Propagation}
                              \PY{n}{metrics}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} Accuracy performance metric}
              
              \PY{c+c1}{\PYZsh{} Return compiled network}
              \PY{k}{return} \PY{n}{network}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}195}]:} \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{wrappers}\PY{n+nn}{.}\PY{n+nn}{scikit\PYZus{}learn} \PY{k}{import} \PY{n}{KerasClassifier}
          \PY{c+c1}{\PYZsh{} Wrap Keras model so it can be used by scikit\PYZhy{}learn}
          \PY{n}{neural\PYZus{}network} \PY{o}{=} \PY{n}{KerasClassifier}\PY{p}{(}\PY{n}{build\PYZus{}fn}\PY{o}{=}\PY{n}{create\PYZus{}network}\PY{p}{,} 
                                           \PY{n}{epochs}\PY{o}{=}\PY{l+m+mi}{11}\PY{p}{,} 
                                           \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} 
                                           \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}198}]:} \PY{c+c1}{\PYZsh{} Evaluate neural network using three\PYZhy{}fold cross\PYZhy{}validation}
          \PY{n}{score} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}score}\PY{p}{(}\PY{n}{neural\PYZus{}network}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}200}]:} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{score}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{10}
          \PY{c+c1}{\PYZsh{}thus the best accuracy has been the Random Forest at 66.5\PYZpc{}}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}200}]:} 0.5099999964237213
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}209}]:} \PY{c+c1}{\PYZsh{}the preformance of random forest on the test data}
          \PY{n}{y\PYZus{}pred}\PY{o}{=}\PY{n}{clf}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test preformance of Random Forest Accuracy:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Test preformance of Random Forest Accuracy: 0.74

    \end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
