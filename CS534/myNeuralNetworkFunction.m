function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 01-Dec-2018 23:37:44.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx25 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx1 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.00114783027181489;0.0156517715286264;0.00658068145556301;0.00124853651116461;0.00577205985726373;0;0.00890376290207654;0.00212743513927397;0.00843619059722781;0.00479039511443104;0;0;0;0;0.00152834821401957;0;0;0;0.00197620139897807;0;0;0;0;0;0.00013098000240188];
x1_step1.gain = [51.2475849924711;191.671594139559;77.9582366274924;41.1270084173293;57.7494588719236;75.0029332759726;112.312065246794;15.0904032097812;118.536914081648;34.7918413169269;52.4274282299467;5.63936779575534;38.2455514571639;24.2051417861761;37.3886373659382;6.30108750167014;7.28321059469284;43.4717887534718;35.7191505534913;8.44521293885646;4.47213595499958;6.6332495807108;2.52803318016789;14.4512581268194;4.44656567120616];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.3862533652576607412;-1.6731652606646880699;1.1641781537492401633;-0.34794891111388087657;-0.027403370597985306917;0.15617751268148372112;-0.77714222862214377141;0.72142926586185562865;-1.1130616548979792579;1.6596509216893091665];
IW1_1 = [-0.47258267401870651669 -0.37037219896899203908 0.047402296211181582652 0.13538099589042409954 0.0062090297293350971142 -0.35975072910842770257 0.1243860099333630731 0.23288932018441260707 -0.61793061408845784133 0.3700730045301008353 -0.25962150587072374552 0.18369440621026450478 0.16856342777812899358 -0.11624611691633926491 -0.12028915127046831135 -0.25164487050367018162 0.48117213438418665605 0.074553622331379021393 -0.13381178627109993617 -0.94105057934981295453 -0.34416465217520197939 -0.16060401069556767828 0.53501329350923765293 0.49055345084303592085 0.37451208703618726892;-0.0081748106280468586793 -0.051221109846216264505 -0.25704203726093211024 0.23456961303435991395 0.20324917948255408207 0.012292421757373432623 -0.019557858782380824203 -0.14358002664620320155 -0.017700847401126519609 0.11359059490082032418 -0.14129793097171081118 -0.36093159371476740693 0.27874727943464694402 0.11396159255866289417 0.01016700314122662846 0.0075537934234356255911 0.012287191998551308739 -0.073508870468602771631 0.10217202745948718301 -3.093640911282603323 0.07396948864513250288 0.063781036461967838269 0.21613038823630950636 -0.018414483059002732107 0.84975541237309615283;-0.27952998113990040752 -0.071906398599932003224 -0.1281932975350923154 0.26387107968799711211 0.23313357836484943642 -0.22947768214738312187 -0.094113058460372461811 -0.50293970342132365836 -0.051434597472807340457 0.049776658650838065401 0.19361616934147587998 0.54599454192802587826 0.063246541158873237354 0.35680979364420195576 -0.098901473459875641203 0.13271118875662510361 -0.36934954705657074836 -0.053573507577605740393 -0.067316753371068599465 2.3650676725854133942 -0.42741910039030378554 -0.070453002399640279885 -0.30385318856592669068 0.091147899988670677551 -0.46354042091008029747;0.37849294709184422292 -0.10649625809949488098 0.10491577848490407643 -0.31367428085487952805 0.013296757897408140181 0.1226604560456886206 0.26415777045682670154 -0.51789565849763807837 0.47237908837594477784 -0.588854887221156309 -0.057164945727314432633 -0.50617408100378846747 0.24613442827502785004 0.029308000257116034043 0.13002670399263849266 -0.56027410140368527625 -0.44486082677281524322 -0.46229325519965530633 0.46804180700081554622 -0.090650468109336329592 -0.31473434274636963304 -0.57714377339005984435 -0.17797913930919126435 0.02473689150717812979 -0.19620718200064826697;-0.25864085444241563527 -0.10064340768869982357 0.24472350727965511141 -0.11409420795586751318 0.23878028477127793971 0.29179587696008496556 -0.065610602005811771709 0.27219859795536727187 -0.25169125187294183466 0.24176454513801717838 0.29445763849773398668 0.02600350342156810407 0.18313137165955861718 0.033435193426794490579 0.32001528292338693449 0.56856869664082410054 -0.1662395871355093202 -0.12202081741857839781 0.50750695793780231657 0.32265143418302238976 0.2230179360275399425 -0.37177749990919450873 0.39305385367702522226 -0.28796137070979999084 0.70077032115669990464;-0.054562589468041294838 0.27568578208244298722 -0.066735483048498814296 -0.31116670484723107926 0.43553513751290229283 0.33133048959503053066 -0.14211442230940496412 0.42563871333795327834 0.52214786383776057299 0.28934914389781585253 0.34932487219220204056 0.5448984596372550282 0.021805546572088038704 0.24898415068179935439 -0.49716977919498778204 0.13798672728735608684 0.27724094710148944332 -0.44120246538807744718 -0.053172524027605007346 -0.27478722001586086687 0.46398102662647322525 -0.21903698095114315647 0.3838088068291690691 0.32720258838163140958 -0.19040253969150114366;-0.4242519727606924862 0.00055655273222543618847 0.10760228516530574716 0.22994684612375154709 -0.37583495191957311254 0.0053289497870418461173 -0.0029170219352956236122 0.48959012102747373474 -0.041163514589603489302 -0.27125123850696475358 0.26013060899374468304 0.51173047263878390645 -0.6328682622941833591 0.031059325412706981911 -0.30430176245781748179 0.13627976900439631169 -0.16235373603702080159 -0.26061710604781879175 0.10887678028895207694 -1.1713445185660122938 -0.2931758767126062537 0.12527962830164018904 -0.23485829191323978615 0.28030415825650495387 0.14345273377916231694;0.060208581968211272173 0.31008926328418373597 -0.35933489717271616115 0.45016178118326455326 0.25094878342021964546 -0.78754920131268513206 -0.028092593051466673709 -0.090916374330557978012 0.12923655176998552485 0.36740995396770514958 0.09629427744204095696 0.2402778480085324686 0.71249703297015309911 -0.075678730339854408116 -0.1843658083562322858 0.5306094181459356518 0.047536917526582900262 0.27829853965047474107 -0.55643529611592346118 -0.80274103798904594687 0.024674097811622417581 0.02925142756985472936 0.11977555279719596937 -0.1135921217282755552 -0.44882091801048679125;-0.33841742230280841275 -0.27209097865841602726 0.12110805722146666952 -0.5213325365171935788 0.10253375821282278979 0.41012380164654843595 -0.3410179065720732039 0.19518470550681868425 0.13452386988578182714 -0.28794375303017616385 -0.14782316233749087653 0.23425604248633280502 0.23326053398380355852 0.14155751375941580394 0.31722833765000135742 0.25068137184777361526 -0.27713503088539476193 -0.14933788045879736739 0.0083354531474538490904 -0.87402406765775275677 -0.12415717039776805186 0.19111331424794769651 0.24016116440636323115 -0.54201093718647530562 -0.034361567333025512527;-0.18211757442420414832 -0.4904032119868860784 -0.12079655084818202715 0.019511415916382661428 0.11241738568505472984 0.14285631109448018727 0.3207306704627606031 -0.56979208557888416653 -0.11770127771742572298 0.14736463336455477013 0.28195867426518622656 0.37711818828364213063 0.21999889263573096931 -0.64439611160272425305 -0.1207695789891314736 0.29681377827579236151 0.07618945021772138837 -0.036665398963510169306 0.12969440137891491416 0.045066964076596410793 -0.035945613938608546312 -0.6465263533117218131 0.3501391368873487675 -0.21896295340424198894 -0.063803800434531557362];

% Layer 2
b2 = 0.26597976560897512721;
LW2_1 = [-0.90635298780612127967 -3.306235109424611629 2.4288895825808869411 1.4084639431648895425 0.34549603652710664248 -0.5914879500007403923 -1.4892644131120607032 -0.8509817684336172805 -0.64601142967690583507 -0.37861727824383484275];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n,~)
a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
